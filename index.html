<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rinde Gastos - Real Co.</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { 
      margin: 0; 
      padding: 0; 
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    #root {
      min-height: 100vh;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">

const RendicionGastosEmpresarial = () => {
  // Estados principales
  const [pagina, setPagina] = useState('bienvenida'); // bienvenida, registro, origenes, gastos, visualizacion, confirmacion
  
  // P√°gina 1: Registro inicial
  const [usuario, setUsuario] = useState('');
  const [fechaRendicion, setFechaRendicion] = useState('');
  const [tituloRendicion, setTituloRendicion] = useState('');
  const [local, setLocal] = useState('');
  const [beneficiario, setBeneficiario] = useState('');
  const [locales, setLocales] = useState([]);
  
  // P√°gina 2: Or√≠genes de fondos
  const [origenesFondos, setOrigenesFondos] = useState([]);
  
  // P√°gina 3: Gastos
  const [gastos, setGastos] = useState([]);
  const [gastoEnEdicion, setGastoEnEdicion] = useState(null);
  
  // Estados finales
  const [autorizador, setAutorizador] = useState('');
  const [copiado, setCopiado] = useState(false);
  const [mostrarConfirmacion, setMostrarConfirmacion] = useState(false);

  // Cargar locales - Lista manual por restricciones de CSP en Claude.ai
  useEffect(() => {
    // Lista manual de locales (edita esta lista seg√∫n tus necesidades)
    const localesManuales = [
      'Local Santiago Centro',
      'Local Providencia',
      'Local Las Condes',
      'Local Maip√∫',
      'Local √ëu√±oa',
      'Local Vitacura',
      'Oficina Central',
      'Bodega Principal'
    ];
    
    setLocales(localesManuales);
    console.log('üìç Locales cargados (modo manual):', localesManuales);
    
    // Establecer fecha actual por defecto
    const hoy = new Date().toISOString().split('T')[0];
    setFechaRendicion(hoy);
  }, []);

  // ==================== FUNCIONES P√ÅGINA 1 ====================
  const irAOrigenes = () => {
    if (!usuario || !fechaRendicion || !tituloRendicion || !local || !beneficiario) {
      alert('Por favor complete todos los campos obligatorios');
      return;
    }
    setPagina('origenes');
  };

  // ==================== FUNCIONES P√ÅGINA 2 ====================
  const toggleOrigenFondo = (origen) => {
    const origenesActuales = [...origenesFondos];
    const indice = origenesActuales.findIndex(item => item.origen === origen);
    
    // Definir tipos de origen
    const origenesUsuario = [
      'Efectivo del usuario (a reembolsar)',
      'Tarjeta del usuario (a reembolsar)'
    ];
    
    const origenesEmpresa = [
      'Efectivo de Caja local',
      'Efectivo de Caja Chica del local',
      'Giro bancario'
    ];
    
    const origenTarjetaEmpresa = 'Tarjeta de la empresa (d√©bito o cr√©dito)';
    
    // Si intenta agregar, verificar que no se mezclen tipos
    if (indice === -1 && origenesActuales.length > 0) {
      const esOrigenUsuario = origenesUsuario.includes(origen);
      const esOrigenEmpresa = origenesEmpresa.includes(origen);
      const esTarjetaEmpresa = origen === origenTarjetaEmpresa;
      
      const tieneOrigenesUsuario = origenesActuales.some(item => origenesUsuario.includes(item.origen));
      const tieneOrigenesEmpresa = origenesActuales.some(item => origenesEmpresa.includes(item.origen));
      const tieneTarjetaEmpresa = origenesActuales.some(item => item.origen === origenTarjetaEmpresa);
      
      // No permitir mezclas entre los tres tipos
      if ((esOrigenUsuario && (tieneOrigenesEmpresa || tieneTarjetaEmpresa)) ||
          (esOrigenEmpresa && (tieneOrigenesUsuario || tieneTarjetaEmpresa)) ||
          (esTarjetaEmpresa && (tieneOrigenesUsuario || tieneOrigenesEmpresa))) {
        alert('‚ö†Ô∏è No puedes mezclar diferentes tipos de fondos.\n\nüìå Si deseas combinar diferentes tipos de fondos, debes declararlos en Rendiciones de Gastos Separadas.');
        return;
      }
    }
    
    if (indice > -1) {
      origenesActuales.splice(indice, 1);
    } else {
      origenesActuales.push({ origen: origen, monto: '' });
    }
    
    setOrigenesFondos(origenesActuales);
  };

  const actualizarMontoOrigen = (origen, monto) => {
    const origenesActuales = [...origenesFondos];
    const indice = origenesActuales.findIndex(item => item.origen === origen);
    
    if (indice > -1) {
      origenesActuales[indice].monto = monto;
      setOrigenesFondos(origenesActuales);
    }
  };

  const origenSeleccionado = (origen) => {
    return origenesFondos.some(item => item.origen === origen);
  };

  const obtenerMontoOrigen = (origen) => {
    const item = origenesFondos.find(item => item.origen === origen);
    return item?.monto || '';
  };

  const calcularTotalFondos = () => {
    return origenesFondos.reduce((total, item) => {
      const monto = parseFloat(item.monto) || 0;
      return total + monto;
    }, 0);
  };

  const obtenerTipoFondos = () => {
    const origenesUsuario = [
      'Efectivo del usuario (a reembolsar)',
      'Tarjeta del usuario (a reembolsar)'
    ];
    
    const origenTarjetaEmpresa = 'Tarjeta de la empresa (d√©bito o cr√©dito)';
    
    if (origenesFondos.length === 0) return null;
    
    const esUsuario = origenesFondos.some(item => origenesUsuario.includes(item.origen));
    const esTarjetaEmpresa = origenesFondos.some(item => item.origen === origenTarjetaEmpresa);
    
    if (esUsuario) return 'USUARIO';
    if (esTarjetaEmpresa) return 'TARJETA_EMPRESA';
    return 'EMPRESA';
  };

  const tieneTarjetaEmpresa = () => {
    return origenesFondos.some(item => item.origen === 'Tarjeta de la empresa (d√©bito o cr√©dito)');
  };

  const irAGastos = () => {
    if (origenesFondos.length === 0) {
      alert('Debe seleccionar al menos un origen de fondos');
      return;
    }
    
    const faltanMontos = origenesFondos.some(item => !item.monto || parseFloat(item.monto) <= 0);
    if (faltanMontos) {
      alert('Debe ingresar un monto v√°lido para cada origen de fondos seleccionado');
      return;
    }
    
    setPagina('gastos');
  };

  // ==================== FUNCIONES P√ÅGINA 3 ====================
  const generarFolioUnico = () => {
    const ahora = new Date();
    const a√±o = ahora.getFullYear();
    const mes = String(ahora.getMonth() + 1).padStart(2, '0');
    const dia = String(ahora.getDate()).padStart(2, '0');
    const horas = String(ahora.getHours()).padStart(2, '0');
    const minutos = String(ahora.getMinutes()).padStart(2, '0');
    const segundos = String(ahora.getSeconds()).padStart(2, '0');
    return `${a√±o}${mes}${dia}_${horas}${minutos}${segundos}`;
  };

  const iniciarNuevoGasto = () => {
    const nuevoGasto = {
      folioGasto: generarFolioUnico(),
      fecha: new Date().toLocaleString('es-CL', { 
        year: 'numeric', 
        month: '2-digit', 
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      }),
      items: [],
      itemActual: { producto: '', cantidad: '', valorUnitario: '', valorTotal: 0 },
      categoria: '',
      pagoConTarjetaEmpresa: 'NO',
      documentoRespaldo: '',
      folioDocumento: '',
      foto: null,
      urlFoto: '',
      estado: 'Borrador'
    };
    
    setGastoEnEdicion(nuevoGasto);
  };

  const calcularValorTotalItem = (cantidad, valorUnitario) => {
    const cant = parseFloat(cantidad) || 0;
    const valor = parseFloat(valorUnitario) || 0;
    return cant * valor;
  };

  const actualizarItemActual = (campo, valor) => {
    const itemActualizado = { ...gastoEnEdicion.itemActual, [campo]: valor };
    
    if (campo === 'cantidad' || campo === 'valorUnitario') {
      itemActualizado.valorTotal = calcularValorTotalItem(
        itemActualizado.cantidad, 
        itemActualizado.valorUnitario
      );
    }
    
    setGastoEnEdicion({ ...gastoEnEdicion, itemActual: itemActualizado });
  };

  const agregarItem = () => {
    const { producto, cantidad, valorUnitario, valorTotal } = gastoEnEdicion.itemActual;
    
    if (!producto || !cantidad || !valorUnitario) {
      alert('Complete todos los campos del producto/servicio');
      return;
    }
    
    if (parseFloat(cantidad) <= 0 || parseFloat(valorUnitario) <= 0) {
      alert('La cantidad y el valor unitario deben ser mayores a 0');
      return;
    }
    
    const nuevoItem = {
      producto,
      cantidad: parseFloat(cantidad),
      valorUnitario: parseFloat(valorUnitario),
      valorTotal
    };
    
    const itemsActualizados = [...gastoEnEdicion.items, nuevoItem];
    
    setGastoEnEdicion({
      ...gastoEnEdicion,
      items: itemsActualizados,
      itemActual: { producto: '', cantidad: '', valorUnitario: '', valorTotal: 0 }
    });
  };

  const eliminarItem = (indice) => {
    const itemsActualizados = gastoEnEdicion.items.filter((_, i) => i !== indice);
    setGastoEnEdicion({ ...gastoEnEdicion, items: itemsActualizados });
  };

  const calcularTotalItems = (items) => {
    return items.reduce((total, item) => total + item.valorTotal, 0);
  };

  const guardarGasto = () => {
    if (gastoEnEdicion.items.length === 0) {
      alert('Debe agregar al menos un producto/servicio');
      return;
    }
    
    if (!gastoEnEdicion.categoria) {
      alert('Debe seleccionar una categor√≠a del gasto');
      return;
    }
    
    if (tieneTarjetaEmpresa() && !gastoEnEdicion.pagoConTarjetaEmpresa) {
      alert('Debe indicar si este gasto fue realizado con Tarjeta de la Empresa');
      return;
    }
    
    if (!gastoEnEdicion.documentoRespaldo) {
      alert('Debe seleccionar el tipo de documento de respaldo');
      return;
    }
    if (!gastoEnEdicion.folioDocumento && gastoEnEdicion.documentoRespaldo !== 'Sin documento') {
      alert('Debe ingresar el folio del documento');
      return;
    }
    if (gastoEnEdicion.documentoRespaldo === 'Sin documento' && !gastoEnEdicion.foto) {
      alert('Debe cargar una fotograf√≠a cuando no hay documento de respaldo');
      return;
    }
    
    setGastos([...gastos, gastoEnEdicion]);
    setGastoEnEdicion(null);
  };

  const calcularTotalGastosConTarjeta = () => {
    return gastos
      .filter(gasto => gasto.pagoConTarjetaEmpresa === 'SI')
      .reduce((total, gasto) => total + calcularTotalItems(gasto.items), 0);
  };

  const editarGasto = (indice) => {
    setGastoEnEdicion(gastos[indice]);
    const nuevosGastos = gastos.filter((_, i) => i !== indice);
    setGastos(nuevosGastos);
  };

  const eliminarGasto = (indice) => {
    if (confirm('¬øEst√° seguro de eliminar este gasto?')) {
      setGastos(gastos.filter((_, i) => i !== indice));
    }
  };

  const irAVisualizacion = () => {
    if (gastos.length === 0) {
      alert('Debe registrar al menos un gasto');
      return;
    }
    setPagina('visualizacion');
  };

  // ==================== FUNCIONES FINALES ====================
  const calcularTotalGastos = () => {
    return gastos.reduce((total, gasto) => total + calcularTotalItems(gasto.items), 0);
  };

  const finalizarRendicion = () => {
    if (!autorizador) {
      alert('Debe ingresar el nombre de quien autoriza la rendici√≥n');
      return;
    }
    setMostrarConfirmacion(true);
  };

  const volverAEditar = () => {
    setMostrarConfirmacion(false);
  };

  const confirmarRendicion = async () => {
    const totalFondos = calcularTotalFondos();
    const totalGastos = calcularTotalGastos();
    const diferencia = totalFondos - totalGastos;
    const tipoFondos = obtenerTipoFondos();
    
    let conceptoDiferencia = '';
    if (diferencia >= 0) {
      conceptoDiferencia = tipoFondos === 'USUARIO' 
        ? 'REEMBOLSO AL USUARIO' 
        : tipoFondos === 'TARJETA_EMPRESA'
        ? 'SIN VUELTO (TARJETA EMPRESA)'
        : 'VUELTO A LA EMPRESA';
    } else {
      conceptoDiferencia = 'EXCESO DE GASTO';
    }
    
    const datosParaEnviar = {
      fechaRendicion,
      tituloRendicion,
      local,
      usuario,
      beneficiario,
      tipoFondos,
      origenesFondos,
      totalFondos,
      gastos: gastos.map(gasto => ({
        ...gasto,
        totalGasto: calcularTotalItems(gasto.items)
      })),
      autorizador,
      totalGastos,
      diferencia,
      conceptoDiferencia
    };
    
    // URL del Google Apps Script
    const API_URL = 'https://script.google.com/macros/s/AKfycbxP_RprFVQP0UZq8Kkm3BoWBltcmX5a85d_ZTnxdf4Dm2CoBM2SNki2nKlaAnAKaHoXw/exec';
    
    try {
      // Mostrar mensaje de env√≠o
      console.log('‚è≥ Enviando rendici√≥n a Google Sheets...');
      
      // Enviar datos a Google Apps Script
      const response = await fetch(API_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(datosParaEnviar)
      });
      
      console.log('‚úÖ Datos enviados correctamente:', datosParaEnviar);
      
      // Ir a p√°gina de confirmaci√≥n
      setPagina('confirmacion');
      setMostrarConfirmacion(false);
      
    } catch (error) {
      console.error('‚ùå Error al enviar:', error);
      
      // En caso de error, igual continuar (el usuario ver√° el resumen)
      setPagina('confirmacion');
      setMostrarConfirmacion(false);
    }
  };

  const copiarInformacion = () => {
    const totalFondos = calcularTotalFondos();
    const totalGastos = calcularTotalGastos();
    const diferencia = totalFondos - totalGastos;
    const tipoFondos = obtenerTipoFondos();
    
    let texto = `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
    texto += `    RENDICI√ìN DE GASTOS EMPRESARIALES\n`;
    texto += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n`;
    texto += `üìã INFORMACI√ìN GENERAL\n`;
    texto += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
    texto += `T√≠tulo: ${tituloRendicion}\n`;
    texto += `Fecha: ${fechaRendicion}\n`;
    texto += `Usuario: ${usuario}\n`;
    texto += `Local: ${local}\n`;
    texto += `Beneficiario: ${beneficiario}\n`;
    texto += `Autoriza: ${autorizador}\n\n`;
    
    texto += `üíµ OR√çGENES DE FONDOS A RENDIR\n`;
    texto += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
    texto += `Tipo: ${tipoFondos === 'USUARIO' ? 'FONDOS DE USUARIO (Reembolsables)' : 'FONDOS DE EMPRESA (Con vuelto)'}\n\n`;
    origenesFondos.forEach((item) => {
      texto += `   ‚Ä¢ ${item.origen}: $${parseFloat(item.monto).toLocaleString('es-CL')} CLP\n`;
    });
    texto += `   \n`;
    texto += `   TOTAL FONDOS A RENDIR: $${totalFondos.toLocaleString('es-CL')} CLP\n\n`;
    
    texto += `üí∞ DETALLE DE GASTOS (${gastos.length})\n`;
    texto += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n`;
    
    gastos.forEach((gasto, indice) => {
      const totalItems = calcularTotalItems(gasto.items);
      
      texto += `‚ñº GASTO ${indice + 1}\n`;
      texto += `   Folio: ${gasto.folioGasto}\n`;
      texto += `   Fecha: ${gasto.fecha}\n`;
      texto += `   Categor√≠a: ${gasto.categoria}\n`;
      texto += `   \n`;
      texto += `   üì¶ PRODUCTOS/SERVICIOS:\n`;
      gasto.items.forEach((item) => {
        texto += `      ‚Ä¢ ${item.producto}\n`;
        texto += `        Cantidad: ${item.cantidad} √ó $${item.valorUnitario.toLocaleString('es-CL')} = $${item.valorTotal.toLocaleString('es-CL')}\n`;
      });
      texto += `   Subtotal Items: $${totalItems.toLocaleString('es-CL')} CLP\n`;
      texto += `   \n`;
      texto += `   üìÑ DOCUMENTO DE RESPALDO:\n`;
      texto += `   Tipo: ${gasto.documentoRespaldo}\n`;
      texto += `   Folio: ${gasto.folioDocumento || 'N/A'}\n`;
      if (gasto.urlFoto) {
        texto += `   URL Foto: ${gasto.urlFoto}\n`;
      }
      texto += `\n`;
    });
    
    texto += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
    texto += `üíµ RESUMEN FINANCIERO\n`;
    texto += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
    texto += `Total Fondos a Rendir: $${totalFondos.toLocaleString('es-CL')} CLP\n`;
    texto += `Total Gastos Declarados: $${totalGastos.toLocaleString('es-CL')} CLP\n`;
    if (diferencia >= 0) {
      texto += `${tipoFondos === 'USUARIO' ? 'üíµ REEMBOLSO AL USUARIO' : 'üíµ VUELTO A LA EMPRESA'}: $${diferencia.toLocaleString('es-CL')} CLP\n`;
    } else {
      texto += `‚ö†Ô∏è EXCESO DE GASTO: $${Math.abs(diferencia).toLocaleString('es-CL')} CLP\n`;
      texto += `${tipoFondos === 'USUARIO' ? '(Usuario debe aportar la diferencia)' : '(Empresa debe cubrir el exceso)'}\n`;
    }
    texto += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n`;
    texto += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
    texto += `Desarrollado por Real Co.\n`;
    texto += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;

    navigator.clipboard.writeText(texto);
    setCopiado(true);
    setTimeout(() => setCopiado(false), 3000);
  };

  const reiniciarAplicacion = () => {
    setPagina('bienvenida');
    setUsuario('');
    const hoy = new Date().toISOString().split('T')[0];
    setFechaRendicion(hoy);
    setTituloRendicion('');
    setLocal('');
    setBeneficiario('');
    setOrigenesFondos([]);
    setGastos([]);
    setGastoEnEdicion(null);
    setAutorizador('');
    setCopiado(false);
    setMostrarConfirmacion(false);
  };

  // ==================== PANTALLA 0: BIENVENIDA ====================
  if (pagina === 'bienvenida') {
    const fechaHoy = new Date().toLocaleDateString('es-CL', { 
      weekday: 'long', 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    });

    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex items-center justify-center p-4">
        <div className="max-w-lg w-full">
          <div className="bg-white rounded-3xl shadow-2xl overflow-hidden">
            {/* Header con gradiente */}
            <div className="bg-gradient-to-r from-blue-700 via-blue-800 to-blue-900 p-8 text-white relative overflow-hidden">
              <div className="absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full -mr-32 -mt-32"></div>
              <div className="absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full -ml-24 -mb-24"></div>
              
              <div className="relative z-10">
                <div className="flex items-center justify-center mb-6">
                  <div className="bg-white/20 p-4 rounded-2xl backdrop-blur-sm">
                    <Receipt className="w-16 h-16" />
                  </div>
                </div>
                
                <h1 className="text-3xl font-bold text-center mb-2">
                  Bienvenido a tu App
                </h1>
                <h2 className="text-4xl font-extrabold text-center mb-4 tracking-tight">
                  RINDE GASTOS
                </h2>
                
                <div className="flex items-center justify-center space-x-2 text-blue-100">
                  <Calendar className="w-4 h-4" />
                  <p className="text-sm font-medium capitalize">
                    {fechaHoy}
                  </p>
                </div>
              </div>
            </div>

            {/* Contenido principal */}
            <div className="p-8">
              <div className="text-center mb-8">
                <p className="text-gray-700 text-lg font-medium mb-4">
                  Gestiona tus rendiciones de gastos de forma simple y profesional
                </p>
                <p className="text-gray-600 text-sm leading-relaxed">
                  Registra, documenta y controla cada gasto de manera eficiente. 
                  Mant√©n un historial organizado y cumple con los procesos administrativos de tu empresa.
                </p>
              </div>

              {/* Recordatorio importante */}
              <div className="bg-amber-50 border-2 border-amber-300 rounded-xl p-5 mb-8">
                <div className="flex items-start">
                  <div className="flex-shrink-0 mr-3 mt-0.5">
                    <AlertCircle className="w-6 h-6 text-amber-600" />
                  </div>
                  <div>
                    <p className="text-sm font-bold text-amber-900 mb-2">
                      üìã Recordatorio Importante
                    </p>
                    <p className="text-sm text-amber-800 leading-relaxed">
                      Recuerda entregar todos los respaldos f√≠sicos de cada gasto al encargado de registros. 
                      La documentaci√≥n completa es esencial para el proceso de rendici√≥n.
                    </p>
                  </div>
                </div>
              </div>

              {/* Caracter√≠sticas */}
              <div className="grid grid-cols-3 gap-4 mb-8">
                <div className="text-center">
                  <div className="bg-blue-50 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2">
                    <FileText className="w-6 h-6 text-blue-600" />
                  </div>
                  <p className="text-xs font-semibold text-gray-700">Registro Simple</p>
                </div>
                <div className="text-center">
                  <div className="bg-green-50 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2">
                    <DollarSign className="w-6 h-6 text-green-600" />
                  </div>
                  <p className="text-xs font-semibold text-gray-700">Control Total</p>
                </div>
                <div className="text-center">
                  <div className="bg-purple-50 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2">
                    <CheckCircle className="w-6 h-6 text-purple-600" />
                  </div>
                  <p className="text-xs font-semibold text-gray-700">Respaldo Digital</p>
                </div>
              </div>

              {/* Bot√≥n de ingreso */}
              <button
                onClick={() => setPagina('registro')}
                className="w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white py-5 rounded-xl font-bold text-lg hover:from-blue-700 hover:to-blue-900 transition-all shadow-xl hover:shadow-2xl transform hover:scale-105 flex items-center justify-center"
              >
                INGRESAR
                <ArrowRight className="ml-3 w-6 h-6" />
              </button>
            </div>

            {/* Footer */}
            <div className="bg-gray-50 px-8 py-4 border-t border-gray-200">
              <p className="text-xs text-center text-gray-500">Desarrollado por</p>
              <p className="text-sm font-bold text-center text-gray-700">Real Co.</p>
            </div>
          </div>
        </div>
      </div>
    );
  }

  // ==================== P√ÅGINA 1: REGISTRO INICIAL ====================
  if (pagina === 'registro') {
    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-4">
        <div className="max-w-md mx-auto pt-6">
          <div className="bg-white rounded-3xl shadow-2xl overflow-hidden mb-6">
            <div className="bg-gradient-to-r from-blue-700 to-blue-900 p-6 text-white">
              <div className="flex items-center justify-center mb-3">
                <FileText className="w-14 h-14" />
              </div>
              <h1 className="text-2xl font-bold text-center">Rendici√≥n de Gastos</h1>
              <p className="text-center text-blue-100 text-sm mt-2">P√°gina 1 de 3: Registro Inicial</p>
              <p className="text-center text-blue-200 text-xs mt-1">Desarrollado por Real Co.</p>
            </div>
            
            <div className="p-6 space-y-5">
              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Nombre de Usuario *
                </label>
                <input
                  type="text"
                  value={usuario}
                  onChange={(e) => setUsuario(e.target.value)}
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none transition"
                  placeholder="Ingrese su nombre completo"
                />
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Fecha de Rendici√≥n *
                </label>
                <div className="relative">
                  <Calendar className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                  <input
                    type="date"
                    value={fechaRendicion}
                    onChange={(e) => setFechaRendicion(e.target.value)}
                    className="w-full pl-12 pr-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none transition"
                  />
                </div>
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  T√≠tulo de la Rendici√≥n *
                </label>
                <input
                  type="text"
                  value={tituloRendicion}
                  onChange={(e) => setTituloRendicion(e.target.value)}
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none transition"
                  placeholder='Ej: "Compras Marzo 2024", "Gastos Operacionales Semana 10"'
                />
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Local *
                </label>
                <select
                  value={local}
                  onChange={(e) => setLocal(e.target.value)}
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none transition bg-white"
                >
                  <option value="">Seleccione un local</option>
                  {locales.map((loc, idx) => (
                    <option key={idx} value={loc}>{loc}</option>
                  ))}
                </select>
                <p className="text-xs text-gray-500 mt-1">
                  Conectado a: CONTROL DE RENDICION DE GASTOS - COMPRAS ‚Üí VARIABLES DE LOCAL
                </p>
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Beneficiario del Gasto *
                </label>
                <div className="space-y-3">
                  <label className="flex items-center p-4 border-2 border-gray-300 rounded-xl cursor-pointer hover:bg-blue-50 hover:border-blue-500 transition">
                    <input
                      type="radio"
                      value="EMPRESA SAER SPA"
                      checked={beneficiario === 'EMPRESA SAER SPA'}
                      onChange={(e) => setBeneficiario(e.target.value)}
                      className="w-5 h-5 text-blue-600"
                    />
                    <span className="ml-3 font-semibold text-gray-800">EMPRESA SAER SPA</span>
                  </label>
                  <label className="flex items-center p-4 border-2 border-gray-300 rounded-xl cursor-pointer hover:bg-blue-50 hover:border-blue-500 transition">
                    <input
                      type="radio"
                      value="EMPRESA PISA SPA"
                      checked={beneficiario === 'EMPRESA PISA SPA'}
                      onChange={(e) => setBeneficiario(e.target.value)}
                      className="w-5 h-5 text-blue-600"
                    />
                    <span className="ml-3 font-semibold text-gray-800">EMPRESA PISA SPA</span>
                  </label>
                </div>
              </div>

              <button
                onClick={irAOrigenes}
                className="w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white py-4 rounded-xl font-bold text-lg hover:from-blue-700 hover:to-blue-900 transition shadow-lg mt-6 flex items-center justify-center"
              >
                CONTINUAR A OR√çGENES DE FONDOS
                <ArrowRight className="ml-2 w-5 h-5" />
              </button>
            </div>
          </div>
        </div>
      </div>
    );
  }

  // ==================== P√ÅGINA 2: OR√çGENES DE FONDOS ====================
  if (pagina === 'origenes') {
    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-4 pb-24">
        <div className="max-w-md mx-auto pt-4">
          <div className="flex items-center mb-4 text-white">
            <button 
              onClick={() => setPagina('registro')} 
              className="mr-3 p-2 hover:bg-white/10 rounded-lg transition"
            >
              <ArrowLeft className="w-6 h-6" />
            </button>
            <div className="flex-1">
              <h2 className="text-xl font-bold">Or√≠genes de los Fondos a Rendir</h2>
              <p className="text-xs text-blue-200">P√°gina 2 de 3 ‚Ä¢ by Real Co.</p>
            </div>
          </div>

          <div className="bg-white rounded-3xl shadow-2xl p-6 mb-6">
            <div className="bg-blue-50 border-2 border-blue-300 p-4 rounded-xl mb-5">
              <div className="flex items-center mb-2">
                <DollarSign className="w-5 h-5 text-blue-700 mr-2" />
                <p className="text-sm font-semibold text-blue-900">Informaci√≥n de la Rendici√≥n</p>
              </div>
              <p className="text-xs text-gray-700"><span className="font-semibold">T√≠tulo:</span> {tituloRendicion}</p>
              <p className="text-xs text-gray-700"><span className="font-semibold">Local:</span> {local}</p>
              <p className="text-xs text-gray-700"><span className="font-semibold">Fecha:</span> {new Date(fechaRendicion).toLocaleDateString('es-CL')}</p>
            </div>

            <div>
              <label className="block text-sm font-bold text-gray-700 mb-3">
                Seleccione los Or√≠genes de Fondos * (Con montos)
              </label>
              
              <div className="bg-amber-50 border-2 border-amber-300 rounded-lg p-3 mb-4">
                <p className="text-xs font-semibold text-amber-900 mb-1">‚ö†Ô∏è Importante:</p>
                <p className="text-xs text-amber-800">
                  No puedes mezclar diferentes tipos de fondos. Elige solo un tipo.
                </p>
              </div>

              <div className="mb-4">
                <p className="text-xs font-bold text-blue-700 mb-2">üí∞ FONDOS DE USUARIO (Reembolsables)</p>
                <div className="space-y-3">
                  {[
                    'Efectivo del usuario (a reembolsar)',
                    'Tarjeta del usuario (a reembolsar)'
                  ].map((origen) => (
                    <div key={origen} className="border-2 border-blue-300 rounded-lg p-3 hover:border-blue-500 transition bg-blue-50">
                      <label className="flex items-start cursor-pointer">
                        <input
                          type="checkbox"
                          checked={origenSeleccionado(origen)}
                          onChange={() => toggleOrigenFondo(origen)}
                          className="mt-0.5 w-5 h-5 text-blue-600 rounded"
                        />
                        <span className="ml-3 text-sm text-gray-700 flex-1">{origen}</span>
                      </label>
                      {origenSeleccionado(origen) && (
                        <div className="mt-3 ml-8">
                          <label className="block text-xs font-semibold text-gray-600 mb-1">
                            Monto a Rendir en CLP *
                          </label>
                          <div className="relative">
                            <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                            <input
                              type="number"
                              value={obtenerMontoOrigen(origen)}
                              onChange={(e) => actualizarMontoOrigen(origen, e.target.value)}
                              className="w-full pl-7 pr-4 py-2 border-2 border-blue-300 rounded-lg focus:border-blue-600 focus:outline-none transition"
                              placeholder="0"
                              min="0"
                              step="1"
                            />
                          </div>
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              </div>

              <div className="mb-4">
                <p className="text-xs font-bold text-purple-700 mb-2">üí≥ TARJETA DE LA EMPRESA (Solo debes respaldar el gasto total)</p>
                <div className="space-y-3">
                  <div className="border-2 border-purple-300 rounded-lg p-3 hover:border-purple-500 transition bg-purple-50">
                    <label className="flex items-start cursor-pointer">
                      <input
                        type="checkbox"
                        checked={origenSeleccionado('Tarjeta de la empresa (d√©bito o cr√©dito)')}
                        onChange={() => toggleOrigenFondo('Tarjeta de la empresa (d√©bito o cr√©dito)')}
                        className="mt-0.5 w-5 h-5 text-purple-600 rounded"
                      />
                      <span className="ml-3 text-sm text-gray-700 flex-1">Tarjeta de la empresa (d√©bito o cr√©dito)</span>
                    </label>
                    {origenSeleccionado('Tarjeta de la empresa (d√©bito o cr√©dito)') && (
                      <div className="mt-3 ml-8">
                        <label className="block text-xs font-semibold text-gray-600 mb-1">
                          Monto Total del Gasto en CLP *
                        </label>
                        <div className="relative">
                          <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                          <input
                            type="number"
                            value={obtenerMontoOrigen('Tarjeta de la empresa (d√©bito o cr√©dito)')}
                            onChange={(e) => actualizarMontoOrigen('Tarjeta de la empresa (d√©bito o cr√©dito)', e.target.value)}
                            className="w-full pl-7 pr-4 py-2 border-2 border-purple-300 rounded-lg focus:border-purple-600 focus:outline-none transition"
                            placeholder="0"
                            min="0"
                            step="1"
                          />
                        </div>
                        <p className="text-xs text-purple-700 mt-2">
                          ‚ÑπÔ∏è Deber√°s indicar en qu√© gasto(s) se utiliz√≥ esta tarjeta
                        </p>
                      </div>
                    )}
                  </div>
                </div>
              </div>

              <div>
                <p className="text-xs font-bold text-green-700 mb-2">üè¢ FONDOS DE EMPRESA (Con vuelto)</p>
                <div className="space-y-3">
                  {[
                    'Efectivo de Caja local',
                    'Efectivo de Caja Chica del local',
                    'Giro bancario'
                  ].map((origen) => (
                    <div key={origen} className="border-2 border-green-300 rounded-lg p-3 hover:border-green-500 transition bg-green-50">
                      <label className="flex items-start cursor-pointer">
                        <input
                          type="checkbox"
                          checked={origenSeleccionado(origen)}
                          onChange={() => toggleOrigenFondo(origen)}
                          className="mt-0.5 w-5 h-5 text-green-600 rounded"
                        />
                        <span className="ml-3 text-sm text-gray-700 flex-1">{origen}</span>
                      </label>
                      {origenSeleccionado(origen) && (
                        <div className="mt-3 ml-8">
                          <label className="block text-xs font-semibold text-gray-600 mb-1">
                            Monto a Rendir en CLP *
                          </label>
                          <div className="relative">
                            <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                            <input
                              type="number"
                              value={obtenerMontoOrigen(origen)}
                              onChange={(e) => actualizarMontoOrigen(origen, e.target.value)}
                              className="w-full pl-7 pr-4 py-2 border-2 border-green-300 rounded-lg focus:border-green-600 focus:outline-none transition"
                              placeholder="0"
                              min="0"
                              step="1"
                            />
                          </div>
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {origenesFondos.length > 0 && (
              <div className={`mt-6 p-5 rounded-xl text-white shadow-lg ${
                obtenerTipoFondos() === 'USUARIO' 
                  ? 'bg-gradient-to-r from-blue-600 to-blue-700' 
                  : obtenerTipoFondos() === 'TARJETA_EMPRESA'
                  ? 'bg-gradient-to-r from-purple-600 to-purple-700'
                  : 'bg-gradient-to-r from-green-600 to-green-700'
              }`}>
                <p className="text-xs mb-1">
                  {obtenerTipoFondos() === 'USUARIO' 
                    ? 'üí∞ FONDOS DE USUARIO' 
                    : obtenerTipoFondos() === 'TARJETA_EMPRESA'
                    ? 'üí≥ TARJETA DE LA EMPRESA'
                    : 'üè¢ FONDOS DE EMPRESA'}
                </p>
                <p className="text-sm font-semibold mb-2">
                  {obtenerTipoFondos() === 'TARJETA_EMPRESA' 
                    ? 'TOTAL DEL GASTO CON TARJETA' 
                    : 'TOTAL DE FONDOS A RENDIR'}
                </p>
                <p className="text-3xl font-bold">
                  ${calcularTotalFondos().toLocaleString('es-CL')} CLP
                </p>
                <p className="text-xs mt-2 opacity-90">
                  {origenesFondos.length} {origenesFondos.length === 1 ? 'origen seleccionado' : 'or√≠genes seleccionados'}
                </p>
                <div className={`mt-3 pt-3 border-t ${
                  obtenerTipoFondos() === 'USUARIO' 
                    ? 'border-blue-400' 
                    : obtenerTipoFondos() === 'TARJETA_EMPRESA'
                    ? 'border-purple-400'
                    : 'border-green-400'
                }`}>
                  <p className="text-xs font-semibold">
                    {obtenerTipoFondos() === 'USUARIO' 
                      ? 'üìå Si sobra dinero: REEMBOLSO AL USUARIO'
                      : obtenerTipoFondos() === 'TARJETA_EMPRESA'
                      ? 'üìå Solo debes declarar los gastos realizados con esta tarjeta'
                      : 'üìå Si sobra dinero: VUELTO A LA EMPRESA'}
                  </p>
                </div>
              </div>
            )}
          </div>

          <button
            onClick={irAGastos}
            className="w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white py-4 rounded-xl font-bold text-lg hover:from-blue-700 hover:to-blue-900 transition shadow-lg flex items-center justify-center"
          >
            CONTINUAR A DECLARACI√ìN DE GASTOS
            <ArrowRight className="ml-2 w-5 h-5" />
          </button>
        </div>
      </div>
    );
  }

  // ==================== P√ÅGINA 3: DECLARACI√ìN DE GASTOS ====================
  if (pagina === 'gastos') {
    if (gastoEnEdicion) {
      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-4 pb-24">
          <div className="max-w-md mx-auto pt-4">
            <div className="flex items-center mb-4 text-white">
              <button 
                onClick={() => setGastoEnEdicion(null)} 
                className="mr-3 p-2 hover:bg-white/10 rounded-lg transition"
              >
                <ArrowLeft className="w-6 h-6" />
              </button>
              <div className="flex-1">
                <h2 className="text-xl font-bold">Declaraci√≥n de Gasto</h2>
                <p className="text-xs text-blue-200">P√°gina 3 de 3 ‚Ä¢ by Real Co.</p>
              </div>
            </div>

            <div className="bg-white rounded-3xl shadow-2xl p-6 space-y-5">
              <div className="bg-blue-50 border-2 border-blue-300 p-4 rounded-xl">
                <p className="text-xs font-semibold text-blue-700 mb-1">FOLIO √öNICO DEL GASTO</p>
                <p className="text-xl font-bold text-blue-900">{gastoEnEdicion.folioGasto}</p>
                <p className="text-xs text-gray-600 mt-1">Fecha: {gastoEnEdicion.fecha}</p>
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Productos/Servicios * (Agregue items)
                </label>
                
                <div className="bg-blue-50 border-2 border-blue-300 rounded-xl p-4 mb-3 space-y-3">
                  <div>
                    <label className="block text-xs font-semibold text-gray-600 mb-1">
                      Producto/Servicio *
                    </label>
                    <input
                      type="text"
                      value={gastoEnEdicion.itemActual.producto}
                      onChange={(e) => actualizarItemActual('producto', e.target.value)}
                      className="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition text-sm"
                      placeholder="Ej: Tomate, Mouse, Estacionamiento, Bencina..."
                    />
                  </div>

                  <div className="grid grid-cols-2 gap-3">
                    <div>
                      <label className="block text-xs font-semibold text-gray-600 mb-1">
                        Cantidad *
                      </label>
                      <input
                        type="number"
                        value={gastoEnEdicion.itemActual.cantidad}
                        onChange={(e) => actualizarItemActual('cantidad', e.target.value)}
                        className="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition text-sm"
                        placeholder="0"
                        min="0"
                        step="0.01"
                      />
                    </div>

                    <div>
                      <label className="block text-xs font-semibold text-gray-600 mb-1">
                        Valor Unitario *
                      </label>
                      <div className="relative">
                        <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm font-semibold">$</span>
                        <input
                          type="number"
                          value={gastoEnEdicion.itemActual.valorUnitario}
                          onChange={(e) => actualizarItemActual('valorUnitario', e.target.value)}
                          className="w-full pl-7 pr-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:outline-none transition text-sm"
                          placeholder="0"
                          min="0"
                          step="1"
                        />
                      </div>
                    </div>
                  </div>

                  {gastoEnEdicion.itemActual.valorTotal > 0 && (
                    <div className="bg-white p-3 rounded-lg border-2 border-blue-400">
                      <p className="text-xs text-gray-600">Valor Total del Item</p>
                      <p className="text-lg font-bold text-blue-900">
                        ${gastoEnEdicion.itemActual.valorTotal.toLocaleString('es-CL')} CLP
                      </p>
                    </div>
                  )}

                  <button
                    onClick={agregarItem}
                    type="button"
                    className="w-full bg-gradient-to-r from-green-600 to-green-700 text-white py-2 rounded-lg font-semibold hover:from-green-700 hover:to-green-800 transition text-sm"
                  >
                    + AGREGAR ITEM
                  </button>
                </div>

                {gastoEnEdicion.items.length > 0 && (
                  <div className="space-y-2 mb-3">
                    <p className="text-xs font-semibold text-gray-600">Items agregados:</p>
                    {gastoEnEdicion.items.map((item, idx) => (
                      <div key={idx} className="bg-white border-2 border-gray-300 rounded-lg p-3">
                        <div className="flex justify-between items-start mb-2">
                          <div className="flex-1">
                            <p className="font-semibold text-gray-900 text-sm">{item.producto}</p>
                            <p className="text-xs text-gray-600 mt-1">
                              Cantidad: {item.cantidad} √ó ${item.valorUnitario.toLocaleString('es-CL')}
                            </p>
                          </div>
                          <button
                            onClick={() => eliminarItem(idx)}
                            className="p-1 bg-red-100 rounded hover:bg-red-200 transition"
                            type="button"
                          >
                            <Trash2 className="w-4 h-4 text-red-600" />
                          </button>
                        </div>
                        <div className="pt-2 border-t border-gray-200">
                          <p className="text-sm font-bold text-blue-900">
                            Total: ${item.valorTotal.toLocaleString('es-CL')} CLP
                          </p>
                        </div>
                      </div>
                    ))}
                    
                    <div className="bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg p-4 text-white">
                      <p className="text-xs mb-1">Total de Productos/Servicios</p>
                      <p className="text-2xl font-bold">
                        ${calcularTotalItems(gastoEnEdicion.items).toLocaleString('es-CL')} CLP
                      </p>
                    </div>
                  </div>
                )}
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Categor√≠a del Gasto * (Selecci√≥n √∫nica)
                </label>
                <select
                  value={gastoEnEdicion.categoria}
                  onChange={(e) => setGastoEnEdicion({ ...gastoEnEdicion, categoria: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none transition bg-white"
                >
                  <option value="">Seleccione una categor√≠a</option>
                  <option value="Art. Librer√≠a y Computacional">Art. Librer√≠a y Computacional</option>
                  <option value="√ötiles de Aseo">√ötiles de Aseo</option>
                  <option value="Materia Prima">Materia Prima</option>
                  <option value="Gasto Operacional">Gasto Operacional</option>
                  <option value="Gasto en RRHH">Gasto en RRHH</option>
                  <option value="Gasto de Servicios">Gasto de Servicios</option>
                  <option value="Gastos Generales">Gastos Generales</option>
                  <option value="Estacionamiento y Log√≠stica">Estacionamiento y Log√≠stica</option>
                  <option value="Municipalidad MUT">Municipalidad MUT</option>
                </select>
              </div>

              {tieneTarjetaEmpresa() && (
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-2">
                    ¬øEste gasto fue realizado con Tarjeta de la Empresa? *
                  </label>
                  <div className="space-y-2">
                    <label className="flex items-center p-4 border-2 border-gray-300 rounded-xl cursor-pointer hover:bg-purple-50 hover:border-purple-500 transition">
                      <input
                        type="radio"
                        value="SI"
                        checked={gastoEnEdicion.pagoConTarjetaEmpresa === 'SI'}
                        onChange={(e) => setGastoEnEdicion({ ...gastoEnEdicion, pagoConTarjetaEmpresa: e.target.value })}
                        className="w-5 h-5 text-purple-600"
                      />
                      <span className="ml-3 font-semibold text-gray-800">S√≠, se pag√≥ con Tarjeta de la Empresa</span>
                    </label>
                    <label className="flex items-center p-4 border-2 border-gray-300 rounded-xl cursor-pointer hover:bg-gray-50 hover:border-gray-500 transition">
                      <input
                        type="radio"
                        value="NO"
                        checked={gastoEnEdicion.pagoConTarjetaEmpresa === 'NO'}
                        onChange={(e) => setGastoEnEdicion({ ...gastoEnEdicion, pagoConTarjetaEmpresa: e.target.value })}
                        className="w-5 h-5 text-gray-600"
                      />
                      <span className="ml-3 font-semibold text-gray-800">No, se pag√≥ con otro medio</span>
                    </label>
                  </div>
                </div>
              )}

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Tipo de Documento de Respaldo * (Opci√≥n √∫nica)
                </label>
                <select
                  value={gastoEnEdicion.documentoRespaldo}
                  onChange={(e) => setGastoEnEdicion({ ...gastoEnEdicion, documentoRespaldo: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none transition bg-white"
                >
                  <option value="">Seleccione tipo de documento</option>
                  <option value="Boleta">Boleta</option>
                  <option value="Factura">Factura</option>
                  <option value="Gu√≠a de despacho">Gu√≠a de despacho</option>
                  <option value="Vale">Vale</option>
                  <option value="Sin documento">Sin documento</option>
                </select>
              </div>

              <div>
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Folio del Documento {gastoEnEdicion.documentoRespaldo !== 'Sin documento' && '*'}
                </label>
                <input
                  type="text"
                  value={gastoEnEdicion.folioDocumento}
                  onChange={(e) => setGastoEnEdicion({ ...gastoEnEdicion, folioDocumento: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none transition"
                  placeholder="Ingrese el n√∫mero de folio"
                  disabled={gastoEnEdicion.documentoRespaldo === 'Sin documento'}
                />
              </div>

              {gastoEnEdicion.documentoRespaldo === 'Sin documento' && (
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-2">
                    Fotograf√≠a de Respaldo * (Solo una imagen)
                  </label>
                  <div className="border-2 border-dashed border-blue-400 rounded-xl p-8 text-center bg-blue-50 hover:bg-blue-100 transition cursor-pointer">
                    <Camera className="w-16 h-16 mx-auto text-blue-600 mb-3" />
                    <p className="text-sm font-semibold text-gray-700">Toque para cargar fotograf√≠a</p>
                    <p className="text-xs text-gray-500 mt-2">Requerido cuando no hay documento</p>
                    <p className="text-xs text-gray-500">Se guardar√° en Google Drive:</p>
                    <p className="text-xs text-blue-600 font-medium">"Respaldo de Fotograf√≠as de Gastos"</p>
                    <p className="text-xs text-gray-500 mt-1">Nombre: {gastoEnEdicion.folioGasto}</p>
                  </div>
                  {!gastoEnEdicion.foto && (
                    <button
                      onClick={() => setGastoEnEdicion({ 
                        ...gastoEnEdicion, 
                        foto: 'foto_simulada.jpg',
                        urlFoto: `https://drive.google.com/.../${gastoEnEdicion.folioGasto}.jpg`
                      })}
                      className="w-full mt-2 bg-blue-600 text-white py-2 rounded-lg text-sm font-semibold hover:bg-blue-700 transition"
                    >
                      Simular Carga de Foto
                    </button>
                  )}
                  {gastoEnEdicion.foto && (
                    <div className="mt-2 p-3 bg-green-50 border-2 border-green-300 rounded-lg">
                      <p className="text-sm text-green-700 font-semibold">‚úì Fotograf√≠a cargada</p>
                    </div>
                  )}
                </div>
              )}

              <button
                onClick={guardarGasto}
                className="w-full bg-gradient-to-r from-green-600 to-green-800 text-white py-4 rounded-xl font-bold text-lg hover:from-green-700 hover:to-green-900 transition shadow-lg"
              >
                GUARDAR GASTO
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Vista de lista de gastos
    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-4 pb-24">
        <div className="max-w-md mx-auto pt-4">
          <div className="flex items-center mb-4 text-white">
            <button 
              onClick={() => setPagina('origenes')} 
              className="mr-3 p-2 hover:bg-white/10 rounded-lg transition"
            >
              <ArrowLeft className="w-6 h-6" />
            </button>
            <div className="flex-1">
              <h2 className="text-xl font-bold">Declaraci√≥n de Gastos</h2>
              <p className="text-xs text-blue-200">P√°gina 3 de 3 ‚Ä¢ by Real Co.</p>
            </div>
          </div>

          <div className="bg-white rounded-2xl shadow-xl p-5 mb-4">
            <div className="flex items-center mb-2">
              <DollarSign className="w-5 h-5 text-green-700 mr-2" />
              <p className="text-sm font-semibold text-gray-900">Fondos Disponibles</p>
            </div>
            <p className="text-2xl font-bold text-green-900">
              ${calcularTotalFondos().toLocaleString('es-CL')} CLP
            </p>
          </div>

          {gastos.length > 0 && (
            <>
              <div className="text-white mb-4">
                <p className="text-sm font-semibold">Gastos Registrados: {gastos.length}</p>
                <p className="text-xs text-blue-200">Total Gastado: ${calcularTotalGastos().toLocaleString('es-CL')} CLP</p>
              </div>

              <div className="space-y-4 mb-4">
                {gastos.map((gasto, indice) => (
                  <div key={indice} className="bg-white rounded-2xl shadow-xl p-5 border-2 border-gray-200">
                    <div className="flex justify-between items-start mb-4">
                      <div>
                        <p className="text-xs font-semibold text-blue-700">FOLIO</p>
                        <p className="text-lg font-bold text-blue-900">{gasto.folioGasto}</p>
                        <p className="text-xs text-gray-500 mt-1">{gasto.fecha}</p>
                      </div>
                      <div className="flex space-x-2">
                        <button
                          onClick={() => editarGasto(indice)}
                          className="p-2 bg-blue-100 rounded-lg hover:bg-blue-200 transition"
                          title="Editar"
                        >
                          <Edit2 className="w-4 h-4 text-blue-700" />
                        </button>
                        <button
                          onClick={() => eliminarGasto(indice)}
                          className="p-2 bg-red-100 rounded-lg hover:bg-red-200 transition"
                          title="Eliminar"
                        >
                          <Trash2 className="w-4 h-4 text-red-700" />
                        </button>
                      </div>
                    </div>
                    
                    <div className="space-y-2 text-sm border-t border-gray-200 pt-3">
                      <div className="flex">
                        <span className="font-semibold text-gray-600 w-32">Categor√≠a:</span>
                        <span className="text-gray-900">{gasto.categoria}</span>
                      </div>
                      
                      {tieneTarjetaEmpresa() && (
                        <div className="flex">
                          <span className="font-semibold text-gray-600 w-32">Pago:</span>
                          <span className={`font-semibold ${gasto.pagoConTarjetaEmpresa === 'SI' ? 'text-purple-700' : 'text-gray-700'}`}>
                            {gasto.pagoConTarjetaEmpresa === 'SI' ? 'üí≥ Tarjeta Empresa' : 'Otro medio'}
                          </span>
                        </div>
                      )}
                      
                      <div className="flex flex-col">
                        <span className="font-semibold text-gray-600 mb-2">Items:</span>
                        <div className="bg-gray-50 rounded-lg p-3">
                          {gasto.items.map((item, idx) => (
                            <div key={idx} className="text-xs pb-1 border-b border-gray-200 last:border-0 mb-1 last:mb-0">
                              <p className="font-semibold">{item.producto}</p>
                              <p className="text-gray-600">{item.cantidad} √ó ${item.valorUnitario.toLocaleString('es-CL')} = ${item.valorTotal.toLocaleString('es-CL')}</p>
                            </div>
                          ))}
                          <div className="pt-2 mt-2 border-t-2 border-gray-300">
                            <p className="text-sm font-bold text-blue-900">
                              Total: ${calcularTotalItems(gasto.items).toLocaleString('es-CL')} CLP
                            </p>
                          </div>
                        </div>
                      </div>

                      <div className="flex">
                        <span className="font-semibold text-gray-600 w-32">Documento:</span>
                        <span className="text-gray-900">{gasto.documentoRespaldo}</span>
                      </div>
                      <div className="flex">
                        <span className="font-semibold text-gray-600 w-32">Folio Doc:</span>
                        <span className="text-gray-900">{gasto.folioDocumento || 'N/A'}</span>
                      </div>
                      {gasto.urlFoto && (
                        <div className="flex">
                          <span className="font-semibold text-gray-600 w-32">Foto:</span>
                          <span className="text-blue-600 text-xs">Cargada ‚úì</span>
                        </div>
                      )}
                    </div>
                  </div>
                ))}
              </div>
            </>
          )}

          <button
            onClick={iniciarNuevoGasto}
            className="w-full bg-white text-blue-900 py-4 rounded-xl font-bold text-lg hover:bg-blue-50 transition shadow-lg flex items-center justify-center mb-4"
          >
            <Plus className="w-6 h-6 mr-2" />
            AGREGAR GASTO
          </button>

          {gastos.length > 0 && (
            <button
              onClick={irAVisualizacion}
              className="w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white py-4 rounded-xl font-bold text-lg hover:from-blue-700 hover:to-blue-900 transition shadow-lg flex items-center justify-center"
            >
              CONTINUAR A RESUMEN FINAL
              <ArrowRight className="ml-2 w-5 h-5" />
            </button>
          )}

          {gastos.length === 0 && (
            <div className="bg-white rounded-2xl shadow-xl p-8 text-center">
              <AlertCircle className="w-16 h-16 mx-auto text-gray-400 mb-4" />
              <p className="text-gray-600 font-semibold">No hay gastos registrados</p>
              <p className="text-sm text-gray-500 mt-2">Agregue al menos un gasto para continuar</p>
            </div>
          )}
        </div>
      </div>
    );
  }

  // ==================== VISUALIZACI√ìN FINAL ====================
  if (pagina === 'visualizacion') {
    const totalFondos = calcularTotalFondos();
    const totalGastos = calcularTotalGastos();
    const diferencia = totalFondos - totalGastos;
    const tipoFondos = obtenerTipoFondos();

    return (
      <>
        <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-4 pb-24">
          <div className="max-w-md mx-auto pt-4">
            <div className="flex items-center mb-4 text-white">
              <button 
                onClick={() => setPagina('gastos')} 
                className="mr-3 p-2 hover:bg-white/10 rounded-lg transition"
              >
                <ArrowLeft className="w-6 h-6" />
              </button>
              <div className="flex-1">
                <h2 className="text-xl font-bold">Resumen Final</h2>
                <p className="text-xs text-blue-200">Verificaci√≥n y Autorizaci√≥n ‚Ä¢ by Real Co.</p>
              </div>
            </div>

            <div className="bg-white rounded-2xl shadow-xl p-6 mb-4">
              <h3 className="text-lg font-bold text-gray-800 mb-4">Resumen Financiero</h3>
              
              <div className="space-y-3">
                <div className={`border-2 rounded-lg p-4 ${
                  tipoFondos === 'USUARIO' ? 'bg-blue-50 border-blue-300' 
                  : tipoFondos === 'TARJETA_EMPRESA' ? 'bg-purple-50 border-purple-300'
                  : 'bg-green-50 border-green-300'
                }`}>
                  <p className="text-xs font-semibold mb-1" style={{
                    color: tipoFondos === 'USUARIO' ? '#1e40af' 
                      : tipoFondos === 'TARJETA_EMPRESA' ? '#7e22ce'
                      : '#15803d'
                  }}>
                    {tipoFondos === 'USUARIO' ? 'üí∞ Fondos de Usuario' 
                      : tipoFondos === 'TARJETA_EMPRESA' ? 'üí≥ Tarjeta de la Empresa'
                      : 'üè¢ Fondos de Empresa'}
                  </p>
                  <p className="text-xs text-gray-600 font-semibold">
                    {tipoFondos === 'TARJETA_EMPRESA' ? 'Total Declarado con Tarjeta' : 'Total Fondos a Rendir'}
                  </p>
                  <p className="text-2xl font-bold" style={{
                    color: tipoFondos === 'USUARIO' ? '#1e3a8a' 
                      : tipoFondos === 'TARJETA_EMPRESA' ? '#6b21a8'
                      : '#166534'
                  }}>
                    ${totalFondos.toLocaleString('es-CL')} CLP
                  </p>
                </div>

                <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                  <p className="text-xs text-blue-700 font-semibold">Total Gastos Declarados</p>
                  <p className="text-2xl font-bold text-blue-900">
                    ${totalGastos.toLocaleString('es-CL')} CLP
                  </p>
                </div>

                {tipoFondos === 'TARJETA_EMPRESA' && (
                  <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4">
                    <p className="text-xs text-purple-700 font-semibold">Gastos con Tarjeta de Empresa</p>
                    <p className="text-2xl font-bold text-purple-900">
                      ${calcularTotalGastosConTarjeta().toLocaleString('es-CL')} CLP
                    </p>
                    <p className="text-xs text-purple-600 mt-2">
                      {gastos.filter(g => g.pagoConTarjetaEmpresa === 'SI').length} de {gastos.length} gastos con tarjeta
                    </p>
                  </div>
                )}

                {tipoFondos !== 'TARJETA_EMPRESA' && (
                  <div className={`border-2 rounded-lg p-4 ${
                    diferencia >= 0 
                      ? (tipoFondos === 'USUARIO' ? 'bg-blue-50 border-blue-400' : 'bg-green-50 border-green-400')
                      : 'bg-red-50 border-red-300'
                  }`}>
                    <p className={`text-xs font-semibold mb-1 ${
                      diferencia >= 0 
                        ? (tipoFondos === 'USUARIO' ? 'text-blue-700' : 'text-green-700')
                        : 'text-red-700'
                    }`}>
                      {diferencia >= 0 
                        ? (tipoFondos === 'USUARIO' 
                          ? 'üíµ REEMBOLSO AL USUARIO' 
                          : 'üíµ VUELTO A LA EMPRESA')
                        : '‚ö†Ô∏è EXCESO DE GASTO'}
                    </p>
                    <p className={`text-2xl font-bold ${
                      diferencia >= 0 
                        ? (tipoFondos === 'USUARIO' ? 'text-blue-900' : 'text-green-900')
                        : 'text-red-900'
                    }`}>
                      ${Math.abs(diferencia).toLocaleString('es-CL')} CLP
                    </p>
                    {diferencia < 0 && (
                      <p className="text-xs text-red-600 mt-2">
                        {tipoFondos === 'USUARIO' 
                          ? 'El usuario debe aportar la diferencia'
                          : 'La empresa debe cubrir el exceso'}
                      </p>
                    )}
                  </div>
                )}
              </div>
            </div>

            <div className="bg-white rounded-2xl shadow-xl p-6 mb-4">
              <h3 className="text-lg font-bold text-gray-800 mb-4">Informaci√≥n de la Rendici√≥n</h3>
              <div className="space-y-2 text-sm">
                <p><span className="font-semibold text-gray-600">T√≠tulo:</span> {tituloRendicion}</p>
                <p><span className="font-semibold text-gray-600">Fecha:</span> {new Date(fechaRendicion).toLocaleDateString('es-CL')}</p>
                <p><span className="font-semibold text-gray-600">Usuario:</span> {usuario}</p>
                <p><span className="font-semibold text-gray-600">Local:</span> {local}</p>
                <p><span className="font-semibold text-gray-600">Beneficiario:</span> {beneficiario}</p>
                <p><span className="font-semibold text-gray-600">Total Gastos:</span> {gastos.length}</p>
              </div>
            </div>

            <div className="bg-white rounded-2xl shadow-xl p-6 mb-4">
              <h3 className="text-lg font-bold text-gray-800 mb-4">Autorizaci√≥n</h3>
              
              <div className="mb-4">
                <label className="block text-sm font-bold text-gray-700 mb-2">
                  Nombre de quien Autoriza la Rendici√≥n *
                </label>
                <input
                  type="text"
                  value={autorizador}
                  onChange={(e) => setAutorizador(e.target.value)}
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none transition"
                  placeholder="Nombre completo del autorizador"
                />
              </div>

              <button
                onClick={finalizarRendicion}
                className="w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white py-4 rounded-xl font-bold text-lg hover:from-blue-700 hover:to-blue-900 transition shadow-lg"
              >
                FINALIZAR RENDICI√ìN DE GASTOS
              </button>
            </div>
          </div>
        </div>

        {/* MODAL DE CONFIRMACI√ìN - Se renderiza SOBRE la pantalla */}
        {mostrarConfirmacion && (
          <div className="fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-3xl shadow-2xl max-w-md w-full p-6 max-h-[90vh] overflow-y-auto">
              <div className="text-center mb-6">
                <div className="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                  <AlertCircle className="w-10 h-10 text-yellow-600" />
                </div>
                <h3 className="text-xl font-bold text-gray-900 mb-2">
                  Confirmar Env√≠o de Rendici√≥n
                </h3>
                <p className="text-gray-600 text-sm">
                  ¬øEst√° seguro que desea enviar la rendici√≥n de gastos?
                </p>
              </div>

              <div className="bg-blue-50 rounded-xl p-4 mb-4 text-sm">
                <p className="font-semibold text-gray-700 mb-2">Resumen:</p>
                <div className="space-y-1 text-gray-600">
                  <p>‚Ä¢ T√≠tulo: {tituloRendicion}</p>
                  <p>‚Ä¢ Usuario: {usuario}</p>
                  <p>‚Ä¢ Local: {local}</p>
                  <p>‚Ä¢ Beneficiario: {beneficiario}</p>
                  <p>‚Ä¢ Tipo de fondos: {tipoFondos === 'USUARIO' ? 'Usuario (Reembolsable)' : 'Empresa (Con vuelto)'}</p>
                  <p>‚Ä¢ Total fondos: ${totalFondos.toLocaleString('es-CL')}</p>
                  <p>‚Ä¢ Total gastos: ${totalGastos.toLocaleString('es-CL')}</p>
                  <p className={diferencia >= 0 ? (tipoFondos === 'USUARIO' ? 'text-blue-700' : 'text-green-700') : 'text-red-700'}>
                    ‚Ä¢ {diferencia >= 0 
                      ? (tipoFondos === 'USUARIO' ? 'Reembolso usuario' : 'Vuelto empresa')
                      : 'Exceso'}: ${Math.abs(diferencia).toLocaleString('es-CL')}
                  </p>
                  <p>‚Ä¢ Autoriza: {autorizador}</p>
                </div>
              </div>

              <div className="space-y-3">
                <button
                  onClick={confirmarRendicion}
                  className="w-full bg-gradient-to-r from-green-600 to-green-800 text-white py-3 rounded-xl font-bold hover:from-green-700 hover:to-green-900 transition"
                >
                  S√ç, CONFIRMAR ENV√çO
                </button>
                <button
                  onClick={volverAEditar}
                  className="w-full bg-gray-200 text-gray-800 py-3 rounded-xl font-bold hover:bg-gray-300 transition"
                >
                  VOLVER A EDITAR
                </button>
              </div>
            </div>
          </div>
        )}
      </>
    );
  }

  // PANTALLA DE CONFIRMACI√ìN FINAL
  if (pagina === 'confirmacion') {
    const totalFondos = calcularTotalFondos();
    const totalGastos = calcularTotalGastos();
    const diferencia = totalFondos - totalGastos;
    const tipoFondos = obtenerTipoFondos();

    return (
      <div className="min-h-screen bg-gradient-to-br from-green-900 via-emerald-800 to-green-900 p-4 flex items-center justify-center">
        <div className="max-w-md w-full">
          <div className="bg-white rounded-3xl shadow-2xl p-8">
            <div className="w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
              <CheckCircle className="w-16 h-16 text-green-600" />
            </div>
            
            <h2 className="text-2xl font-bold text-gray-900 text-center mb-3">
              ‚úÖ Rendici√≥n Enviada Exitosamente
            </h2>
            
            <div className="bg-green-50 border-2 border-green-300 rounded-xl p-4 mb-4">
              <p className="text-sm font-bold text-green-800 text-center mb-1">
                üìä Datos guardados en Google Sheets
              </p>
              <p className="text-xs text-green-700 text-center">
                La rendici√≥n se ha enviado autom√°ticamente a tu base de datos
              </p>
            </div>
            
            <div className="bg-blue-50 rounded-xl p-5 mb-6 border-2 border-blue-200">
              <p className="text-sm font-semibold text-gray-700 mb-3">Resumen del Env√≠o:</p>
              <div className="space-y-2 text-sm text-gray-600">
                <p><span className="font-semibold">T√≠tulo:</span> {tituloRendicion}</p>
                <p><span className="font-semibold">Fecha:</span> {new Date(fechaRendicion).toLocaleDateString('es-CL')}</p>
                <p><span className="font-semibold">Local:</span> {local}</p>
                <p><span className="font-semibold">Usuario:</span> {usuario}</p>
                <p><span className="font-semibold">Beneficiario:</span> {beneficiario}</p>
                <p><span className="font-semibold">Total Gastos:</span> {gastos.length}</p>
                <p><span className="font-semibold">Autoriza:</span> {autorizador}</p>
              </div>
              <div className="mt-4 pt-3 border-t-2 border-blue-300">
                <p className="text-sm font-semibold text-gray-700 mb-2">Resumen Financiero:</p>
                <p className={`text-xs font-semibold ${tipoFondos === 'USUARIO' ? 'text-blue-700' : 'text-green-700'}`}>
                  Tipo: {tipoFondos === 'USUARIO' ? 'Fondos de Usuario (Reembolsable)' : 'Fondos de Empresa (Con vuelto)'}
                </p>
                <p className="text-xs text-gray-600">Fondos: ${totalFondos.toLocaleString('es-CL')}</p>
                <p className="text-xs text-gray-600">Gastos: ${totalGastos.toLocaleString('es-CL')}</p>
                <p className={`text-sm font-bold ${
                  diferencia >= 0 
                    ? (tipoFondos === 'USUARIO' ? 'text-blue-700' : 'text-green-700')
                    : 'text-red-700'
                }`}>
                  {diferencia >= 0 
                    ? (tipoFondos === 'USUARIO' ? 'üíµ Reembolso Usuario' : 'üíµ Vuelto Empresa')
                    : '‚ö†Ô∏è Exceso'}: ${Math.abs(diferencia).toLocaleString('es-CL')} CLP
                </p>
              </div>
            </div>

            <button
              onClick={copiarInformacion}
              className="w-full bg-gradient-to-r from-gray-600 to-gray-700 text-white py-4 rounded-xl font-bold text-base hover:from-gray-700 hover:to-gray-800 transition shadow-lg flex items-center justify-center mb-4"
            >
              <Copy className="w-5 h-5 mr-2" />
              {copiado ? '‚úÖ COPIADO' : 'COPIAR RESUMEN'}
            </button>

            {copiado && (
              <div className="bg-green-50 border-2 border-green-300 rounded-xl p-3 mb-4">
                <p className="text-sm text-green-700 font-semibold text-center">
                  ‚úÖ Informaci√≥n copiada al portapapeles
                </p>
              </div>
            )}

            <p className="text-xl font-bold text-gray-900 text-center mb-6">
              üéâ Gracias por rendir tus gastos.
            </p>

            <button
              onClick={reiniciarAplicacion}
              className="w-full bg-gradient-to-r from-blue-600 to-blue-800 text-white py-4 rounded-xl font-bold text-lg hover:from-blue-700 hover:to-blue-900 transition shadow-lg"
            >
              ¬øDESEAS HACER OTRA RENDICI√ìN DE GASTOS?
            </button>

            <div className="mt-8 pt-4 border-t border-gray-200">
              <p className="text-xs text-gray-400 text-center">Desarrollado por</p>
              <p className="text-sm font-bold text-gray-700 text-center">Real Co.</p>
            </div>
          </div>
        </div>
      </div>
    );
  }

  return null;
};

export default RendicionGastosEmpresarial;
    // Renderizar la aplicaci√≥n
    ReactDOM.render(<RendicionGastosEmpresarial />, document.getElementById('root'));
  </script>
</body>
</html>
